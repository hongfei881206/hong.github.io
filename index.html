<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸€é”®è·³è½¬é¡µé¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background-color: #f8f9fa;
            text-align: center;
            padding: 30px 20px;
            font-family: "Microsoft YaHei", sans-serif;
            position: relative;
        }
        /* ç®¡ç†å‘˜æŒ‰é’® - å³ä¸Šè§’æ ·å¼ */
        .admin-entry {
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 100;
        }
        .admin-btn {
            padding: 6px 12px;
            background-color: #495057;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .admin-btn:hover {
            background-color: #343a40;
            transform: translateY(-1px);
            box-shadow: 0 3px 7px rgba(0,0,0,0.15);
        }
        .admin-btn::before {
            content: "ğŸ”";
        }
        /* æ–‡å­—ç¼–è¾‘åŒºåŸŸ */
        .text-content {
            margin: 20px auto;
            padding: 20px;
            min-height: 60px;
            max-width: 800px;
            word-wrap: break-word;
            transition: all 0.3s ease;
        }
        /* å¯†ç éªŒè¯åŒºåŸŸæ ·å¼ */
        .auth-panel {
            margin: 10px auto 20px;
            max-width: 450px;
            display: flex;
            gap: 12px;
            justify-content: center;
            align-items: center;
            display: none;
        }
        .auth-panel input {
            padding: 10px 15px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            width: 250px;
            font-size: 16px;
        }
        .auth-panel button {
            padding: 10px 20px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .auth-panel button:hover {
            background-color: #218838;
        }
        /* ä¿®æ”¹å¯†ç åŒºåŸŸ */
        .change-pwd-panel {
            margin: 10px auto 20px;
            max-width: 500px;
            display: none;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }
        .change-pwd-panel input {
            padding: 10px 15px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            width: 100%;
            font-size: 16px;
        }
        .change-pwd-panel button {
            padding: 10px 20px;
            background-color: #17a2b8;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .change-pwd-panel button:hover {
            background-color: #138496;
        }
        /* è‡ªå®šä¹‰è®¾ç½®é¢æ¿æ ·å¼ */
        .setting-panel {
            max-width: 650px;
            margin: 25px auto;
            padding: 25px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
            display: none;
            gap: 20px;
            flex-direction: column;
        }
        /* æ–‡å­—è®¾ç½®åŒºåŸŸ */
        .text-setting {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
        }
        .text-setting input, .text-setting select {
            padding: 10px 15px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 16px;
        }
        .setting-panel input {
            padding: 12px 15px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 16px;
        }
        /* å›¾ç‰‡ä¸Šä¼ åŒºåŸŸ */
        .image-upload {
            margin: 15px 0;
        }
        .upload-btn {
            padding: 8px 16px;
            background-color: #6c757d;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
            margin-right: 10px;
        }
        .upload-btn:hover {
            background-color: #5a6268;
        }
        .upload-info {
            font-size: 13px;
            color: #6c757d;
            margin-top: 8px;
            display: inline-block;
        }
        #fileInput {
            display: none;
        }
        .preview-container {
            margin: 15px 0;
            max-width: 100%;
            display: none;
        }
        .preview-img {
            max-width: 100%;
            max-height: 200px;
            border-radius: 6px;
            border: 1px solid #dee2e6;
            padding: 5px;
        }
        /* æŒ‰é’®ç»„æ ·å¼ */
        .setting-btn-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 10px;
        }
        .setting-btn-group button {
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .confirm-btn {
            background-color: #007bff;
            color: white;
        }
        .confirm-btn:hover {
            background-color: #0069d9;
        }
        .reset-btn {
            background-color: #dc3545;
            color: white;
        }
        .reset-btn:hover {
            background-color: #c82333;
        }
        /* è·³è½¬å›¾ç‰‡æ ·å¼ */
        .jump-img {
            max-width: 75%;
            height: auto;
            margin: 40px auto;
            cursor: pointer;
            border-radius: 10px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.15);
            transition: transform 0.3s;
        }
        .jump-img:hover {
            transform: scale(1.02);
        }
        /* åŠŸèƒ½æŒ‰é’®åŒºåŸŸ */
        .function-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 10px 0;
            display: none;
        }
        .function-buttons button {
            padding: 8px 15px;
            background-color: #6c757d;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        .function-buttons button:hover {
            background-color: #5a6268;
            transform: translateY(-1px);
        }
        /* é¢æ¿æ ‡é¢˜æ ·å¼ */
        .panel-title {
            color: #343a40;
            margin-bottom: 10px;
            font-size: 18px;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 8px;
        }
    </style>
</head>
<body>
    <!-- ç®¡ç†å‘˜å…¥å£ - å³ä¸Šè§’ -->
    <div class="admin-entry">
        <button class="admin-btn" onclick="showAuthPanel()">ç®¡ç†å‘˜</button>
    </div>
    
    <!-- åŠŸèƒ½æŒ‰é’®åŒºåŸŸï¼ˆéªŒè¯åæ˜¾ç¤ºï¼‰ -->
    <div class="function-buttons" id="functionButtons">
        <button onclick="showSettingPanel()">ä¿®æ”¹é…ç½®</button>
        <button onclick="showChangePwdPanel()">ä¿®æ”¹å¯†ç </button>
    </div>

    <!-- å¯†ç éªŒè¯åŒºåŸŸï¼ˆé»˜è®¤éšè—ï¼‰ -->
    <div class="auth-panel" id="authPanel">
        <input type="password" id="adminPwd" placeholder="è¾“å…¥ç®¡ç†å‘˜å¯†ç ">
        <button onclick="verifyAdmin()">éªŒè¯èº«ä»½</button>
    </div>

    <!-- ä¿®æ”¹å¯†ç åŒºåŸŸï¼ˆé»˜è®¤éšè—ï¼‰ -->
    <div class="change-pwd-panel" id="changePwdPanel">
        <h3 class="panel-title">ä¿®æ”¹ç®¡ç†å‘˜å¯†ç </h3>
        <input type="password" id="oldPwd" placeholder="è¾“å…¥æ—§å¯†ç ">
        <input type="password" id="newPwd" placeholder="è¾“å…¥æ–°å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰">
        <input type="password" id="confirmPwd" placeholder="ç¡®è®¤æ–°å¯†ç ">
        <button onclick="changePassword()">ç¡®è®¤ä¿®æ”¹</button>
    </div>

    <!-- æ–‡å­—ç¼–è¾‘åŒºåŸŸ -->
    <div class="text-content" id="textContent" contenteditable="false">
        ç‚¹å‡»æ­¤å¤„å¯ç¼–è¾‘æ–‡å­—å†…å®¹
    </div>

    <!-- è‡ªå®šä¹‰è®¾ç½®é¢æ¿ï¼ˆé»˜è®¤éšè—ï¼‰ -->
    <div class="setting-panel" id="settingPanel">
        <!-- æ–‡å­—è®¾ç½® -->
        <div>
            <h3 class="panel-title">æ–‡å­—è®¾ç½®</h3>
            <div class="text-setting">
                <input type="text" id="textContentInput" placeholder="è¾“å…¥æ–‡å­—å†…å®¹">
                <input type="number" id="fontSize" min="12" max="72" value="16" placeholder="å­—ä½“å¤§å°">
                <input type="color" id="fontColor" value="#000000">
                <button class="confirm-btn" onclick="applyTextSettings()">åº”ç”¨æ–‡å­—è®¾ç½®</button>
            </div>
        </div>
        
        <!-- å›¾ç‰‡å’Œè·³è½¬è®¾ç½® -->
        <div>
            <h3 class="panel-title">å›¾ç‰‡å’Œè·³è½¬è®¾ç½®</h3>
            <input type="text" id="imgUrl" placeholder="è¾“å…¥å›¾ç‰‡é“¾æ¥ï¼ˆhttp/httpså¼€å¤´ï¼‰">
            
            <!-- å›¾ç‰‡ä¸Šä¼ åŒºåŸŸ -->
            <div class="image-upload">
                <button class="upload-btn" onclick="document.getElementById('fileInput').click()">ä¸Šä¼ æœ¬åœ°å›¾ç‰‡</button>
                <input type="file" id="fileInput" accept="image/*">
                <span class="upload-info">æ”¯æŒJPGã€PNGç­‰å¸¸è§å›¾ç‰‡æ ¼å¼</span>
                
                <!-- å›¾ç‰‡é¢„è§ˆåŒºåŸŸ -->
                <div class="preview-container" id="previewContainer">
                    <img src="" alt="é¢„è§ˆå›¾" class="preview-img" id="previewImg">
                </div>
            </div>
            
            <input type="text" id="jumpUrl" placeholder="è¾“å…¥è·³è½¬ç½‘å€ï¼ˆhttp/httpså¼€å¤´ï¼‰">
        </div>
        
        <div class="setting-btn-group">
            <button class="confirm-btn" onclick="saveSetting()">ä¿å­˜è®¾ç½®</button>
            <button class="reset-btn" onclick="resetSetting()">æ¢å¤é»˜è®¤</button>
        </div>
    </div>

    <!-- è·³è½¬å›¾ç‰‡åŒºåŸŸ -->
    <a id="jumpLink" target="_blank">
        <img src="https://picsum.photos/800/450" 
             alt="ç‚¹å‡»ç«‹å³è·³è½¬" 
             class="jump-img" 
             id="targetImg">
    </a>

    <script>
        // ä»æœ¬åœ°å­˜å‚¨è·å–ç®¡ç†å‘˜å¯†ç ï¼Œé»˜è®¤ä¸ºåˆå§‹å¯†ç 
        let ADMIN_PASSWORD = localStorage.getItem("adminPassword") || "HongFei@2024";
        // é»˜è®¤é…ç½®
        const DEFAULT_CONFIG = {
            imgUrl: "https://picsum.photos/800/450",
            jumpUrl: "https://www.baidu.com",
            textContent: "ç‚¹å‡»æ­¤å¤„å¯ç¼–è¾‘æ–‡å­—å†…å®¹",
            fontSize: 16,
            fontColor: "#000000"
        };

        // é¡µé¢åŠ è½½æ—¶è¯»å–æœ¬åœ°å­˜å‚¨çš„é…ç½®
        window.onload = function() {
            loadSetting();
            // ç»‘å®šæ–‡ä»¶ä¸Šä¼ äº‹ä»¶
            document.getElementById("fileInput").addEventListener("change", handleFileUpload);
        };

        // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // æ£€æŸ¥æ–‡ä»¶ç±»å‹
            if (!file.type.startsWith('image/')) {
                alert("è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶");
                return;
            }
            
            // æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆé™åˆ¶10MBä»¥å†…ï¼‰
            if (file.size > 10 * 1024 * 1024) {
                alert("å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡10MB");
                return;
            }
            
            // è¯»å–æ–‡ä»¶å¹¶æ˜¾ç¤ºé¢„è§ˆ
            const reader = new FileReader();
            reader.onload = function(e) {
                const previewContainer = document.getElementById("previewContainer");
                const previewImg = document.getElementById("previewImg");
                const imgUrlInput = document.getElementById("imgUrl");
                
                // æ˜¾ç¤ºé¢„è§ˆ
                previewImg.src = e.target.result;
                previewContainer.style.display = "block";
                
                // å°†base64ç¼–ç å¡«å…¥å›¾ç‰‡é“¾æ¥è¾“å…¥æ¡†
                imgUrlInput.value = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        // æ˜¾ç¤ºå¯†ç éªŒè¯é¢æ¿
        function showAuthPanel() {
            document.getElementById("authPanel").style.display = "flex";
            document.getElementById("changePwdPanel").style.display = "none";
            document.getElementById("settingPanel").style.display = "none";
        }

        // æ˜¾ç¤ºè®¾ç½®é¢æ¿
        function showSettingPanel() {
            document.getElementById("settingPanel").style.display = "flex";
            document.getElementById("authPanel").style.display = "none";
            document.getElementById("changePwdPanel").style.display = "none";
        }

        // æ˜¾ç¤ºä¿®æ”¹å¯†ç é¢æ¿
        function showChangePwdPanel() {
            document.getElementById("changePwdPanel").style.display = "flex";
            document.getElementById("authPanel").style.display = "none";
            document.getElementById("settingPanel").style.display = "none";
        }

        // éªŒè¯ç®¡ç†å‘˜èº«ä»½
        function verifyAdmin() {
            const inputPwd = document.getElementById("adminPwd").value;
            if (inputPwd === ADMIN_PASSWORD) {
                document.getElementById("functionButtons").style.display = "flex";
                document.getElementById("authPanel").style.display = "none";
                // ç®¡ç†å‘˜å¯ç¼–è¾‘æ–‡å­—
                document.getElementById("textContent").contentEditable = true;
                document.getElementById("textContent").style.outline = "1px dashed #007bff";
                alert("éªŒè¯æˆåŠŸï¼å¯è¿›è¡Œè‡ªå®šä¹‰é…ç½®");
            } else {
                alert("å¯†ç é”™è¯¯ï¼Œä»…ç®¡ç†å‘˜å¯ä¿®æ”¹é…ç½®");
            }
        }

        // ä¿®æ”¹å¯†ç 
        function changePassword() {
            const oldPwd = document.getElementById("oldPwd").value;
            const newPwd = document.getElementById("newPwd").value;
            const confirmPwd = document.getElementById("confirmPwd").value;

            if (oldPwd !== ADMIN_PASSWORD) {
                alert("æ—§å¯†ç ä¸æ­£ç¡®");
                return;
            }

            if (newPwd.length < 6) {
                alert("æ–°å¯†ç é•¿åº¦ä¸èƒ½å°‘äº6ä½");
                return;
            }

            if (newPwd !== confirmPwd) {
                alert("ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´");
                return;
            }

            // ä¿å­˜æ–°å¯†ç 
            ADMIN_PASSWORD = newPwd;
            localStorage.setItem("adminPassword", newPwd);
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            document.getElementById("oldPwd").value = "";
            document.getElementById("newPwd").value = "";
            document.getElementById("confirmPwd").value = "";
            
            alert("å¯†ç ä¿®æ”¹æˆåŠŸï¼Œè¯·ä½¿ç”¨æ–°å¯†ç ç™»å½•");
            showAuthPanel();
            document.getElementById("functionButtons").style.display = "none";
            document.getElementById("textContent").contentEditable = false;
            document.getElementById("textContent").style.outline = "none";
        }

        // åº”ç”¨æ–‡å­—è®¾ç½®
        function applyTextSettings() {
            const textContent = document.getElementById("textContentInput").value;
            const fontSize = document.getElementById("fontSize").value;
            const fontColor = document.getElementById("fontColor").value;
            
            const textElement = document.getElementById("textContent");
            
            if (textContent) {
                textElement.textContent = textContent;
            }
            if (fontSize) {
                textElement.style.fontSize = `${fontSize}px`;
            }
            textElement.style.color = fontColor;
            
            // æ›´æ–°è¾“å…¥æ¡†çš„å€¼
            document.getElementById("textContentInput").value = textElement.textContent;
        }

        // è¯»å–æœ¬åœ°å­˜å‚¨çš„é…ç½®å¹¶åº”ç”¨
        function loadSetting() {
            const savedConfig = localStorage.getItem("jumpConfig");
            const config = savedConfig ? JSON.parse(savedConfig) : DEFAULT_CONFIG;
            
            // åº”ç”¨å›¾ç‰‡å’Œè·³è½¬é…ç½®
            document.getElementById("targetImg").src = config.imgUrl;
            document.getElementById("jumpLink").href = config.jumpUrl;
            
            // åº”ç”¨æ–‡å­—é…ç½®
            const textElement = document.getElementById("textContent");
            textElement.textContent = config.textContent;
            textElement.style.fontSize = `${config.fontSize}px`;
            textElement.style.color = config.fontColor;
            
            // å¡«å……åˆ°è¾“å…¥æ¡†
            document.getElementById("imgUrl").value = config.imgUrl;
            document.getElementById("jumpUrl").value = config.jumpUrl;
            document.getElementById("textContentInput").value = config.textContent;
            document.getElementById("fontSize").value = config.fontSize;
            document.getElementById("fontColor").value = config.fontColor;
        }

        // ä¿å­˜è‡ªå®šä¹‰é…ç½®
        function saveSetting() {
            const imgUrl = document.getElementById("imgUrl").value.trim();
            const jumpUrl = document.getElementById("jumpUrl").value.trim();
            const textContent = document.getElementById("textContent").textContent;
            const fontSize = document.getElementById("fontSize").value;
            const fontColor = document.getElementById("fontColor").value;
            
            if (!imgUrl || !jumpUrl) {
                alert("å›¾ç‰‡é“¾æ¥å’Œè·³è½¬ç½‘å€ä¸èƒ½ä¸ºç©ºï¼Œè¯·è¡¥å……å®Œæ•´");
                return;
            }
            
            // éªŒè¯ç½‘å€æ ¼å¼ï¼ˆå›¾ç‰‡å¯ä»¥æ˜¯base64æ ¼å¼ï¼‰
            const urlReg = /^https?:\/\/.+/;
            if (!urlReg.test(jumpUrl) && !(urlReg.test(imgUrl) || imgUrl.startsWith("data:image/"))) {
                alert("è¯·è¾“å…¥æœ‰æ•ˆçš„http/httpsé“¾æ¥ï¼Œæˆ–base64æ ¼å¼å›¾ç‰‡");
                return;
            }
            
            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            const config = { 
                imgUrl, 
                jumpUrl,
                textContent,
                fontSize,
                fontColor
            };
            localStorage.setItem("jumpConfig", JSON.stringify(config));
            
            // ç«‹å³åº”ç”¨é…ç½®
            document.getElementById("targetImg").src = imgUrl;
            document.getElementById("jumpLink").href = jumpUrl;
            document.getElementById("textContent").style.fontSize = `${fontSize}px`;
            document.getElementById("textContent").style.color = fontColor;
            
            alert("é…ç½®ä¿å­˜æˆåŠŸï¼é¡µé¢å·²æ›´æ–°");
        }

        // æ¢å¤é»˜è®¤é…ç½®
        function resetSetting() {
            if (confirm("ç¡®å®šè¦æ¢å¤é»˜è®¤é…ç½®å—ï¼Ÿå½“å‰è‡ªå®šä¹‰è®¾ç½®å°†è¢«æ¸…é™¤")) {
                localStorage.removeItem("jumpConfig");
                // é‡ç½®é¢„è§ˆåŒºåŸŸ
                document.getElementById("previewContainer").style.display = "none";
                document.getElementById("previewImg").src = "";
                document.getElementById("fileInput").value = "";
                loadSetting();
                alert("å·²æˆåŠŸæ¢å¤é»˜è®¤é…ç½®");
            }
        }
    </script>
</body>
</html>